var is=Object.create;var tt=Object.defineProperty;var ss=Object.getOwnPropertyDescriptor;var as=Object.getOwnPropertyNames;var os=Object.getPrototypeOf,us=Object.prototype.hasOwnProperty;var sr=t=>tt(t,"__esModule",{value:!0});var h=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Te=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of as(e))!us.call(t,n)&&n!=="default"&&tt(t,n,{get:()=>e[n],enumerable:!(r=ss(e,n))||r.enumerable});return t},ls=t=>Te(sr(tt(t!=null?is(os(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var rt=h(ar=>{"use strict";ar.parse=function(t,e){return new Me(t,e).parse()};var Me=class{constructor(e,r){this.source=e,this.transform=r||fs,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var r;(this.recorded.length>0||e)&&(r=this.recorded.join(""),r==="NULL"&&!e&&(r=null),r!==null&&(r=this.transform(r)),this.entries.push(r),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var r,n,i;for(this.consumeDimensions();!this.isEof();)if(r=this.nextCharacter(),r.value==="{"&&!i)this.dimension++,this.dimension>1&&(n=new Me(this.source.substr(this.position-1),this.transform),this.entries.push(n.parse(!0)),this.position+=n.position-2);else if(r.value==="}"&&!i){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else r.value==='"'&&!r.escaped?(i&&this.newEntry(!0),i=!i):r.value===","&&!i?this.newEntry():this.record(r.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function fs(t){return t}});var nt=h((Fl,or)=>{var hs=rt();or.exports={create:function(t,e){return{parse:function(){return hs.parse(t,e)}}}}});var fr=h((Ql,lr)=>{"use strict";var cs=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,ds=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,ps=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,ys=/^-?infinity$/;lr.exports=function(e){if(ys.test(e))return Number(e.replace("i","I"));var r=cs.exec(e);if(!r)return _s(e)||null;var n=!!r[8],i=parseInt(r[1],10);n&&(i=ur(i));var s=parseInt(r[2],10)-1,a=r[3],o=parseInt(r[4],10),u=parseInt(r[5],10),l=parseInt(r[6],10),f=r[7];f=f?1e3*parseFloat(f):0;var c,y=ms(e);return y!=null?(c=new Date(Date.UTC(i,s,a,o,u,l,f)),it(i)&&c.setUTCFullYear(i),y!==0&&c.setTime(c.getTime()-y)):(c=new Date(i,s,a,o,u,l,f),it(i)&&c.setFullYear(i)),c};function _s(t){var e=ds.exec(t);if(!!e){var r=parseInt(e[1],10),n=!!e[4];n&&(r=ur(r));var i=parseInt(e[2],10)-1,s=e[3],a=new Date(r,i,s);return it(r)&&a.setFullYear(r),a}}function ms(t){if(t.endsWith("+00"))return 0;var e=ps.exec(t.split(" ")[1]);if(!!e){var r=e[1];if(r==="Z")return 0;var n=r==="-"?-1:1,i=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return i*n*1e3}}function ur(t){return-(t-1)}function it(t){return t>=0&&t<100}});var cr=h((jl,hr)=>{hr.exports=vs;var gs=Object.prototype.hasOwnProperty;function vs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)gs.call(r,n)&&(t[n]=r[n])}return t}});var yr=h((Ul,pr)=>{"use strict";var bs=cr();pr.exports=K;function K(t){if(!(this instanceof K))return new K(t);bs(this,Is(t))}var ws=["seconds","minutes","hours","days","months","years"];K.prototype.toPostgres=function(){var t=ws.filter(this.hasOwnProperty,this);return this.milliseconds&&t.indexOf("seconds")<0&&t.push("seconds"),t.length===0?"0":t.map(function(e){var r=this[e]||0;return e==="seconds"&&this.milliseconds&&(r=(r+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),r+" "+e},this).join(" ")};var Ss={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},Es=["years","months","days"],Rs=["hours","minutes","seconds"];K.prototype.toISOString=K.prototype.toISO=function(){var t=Es.map(r,this).join(""),e=Rs.map(r,this).join("");return"P"+t+"T"+e;function r(n){var i=this[n]||0;return n==="seconds"&&this.milliseconds&&(i=(i+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),i+Ss[n]}};var st="([+-]?\\d+)",Ts=st+"\\s+years?",Ms=st+"\\s+mons?",Ps=st+"\\s+days?",As="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",Cs=new RegExp([Ts,Ms,Ps,As].map(function(t){return"("+t+")?"}).join("\\s*")),dr={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},xs=["hours","minutes","seconds","milliseconds"];function Os(t){var e=t+"000000".slice(t.length);return parseInt(e,10)/1e3}function Is(t){if(!t)return{};var e=Cs.exec(t),r=e[8]==="-";return Object.keys(dr).reduce(function(n,i){var s=dr[i],a=e[s];return!a||(a=i==="milliseconds"?Os(a):parseInt(a,10),!a)||(r&&~xs.indexOf(i)&&(a*=-1),n[i]=a),n},{})}});var mr=h((Wl,_r)=>{"use strict";_r.exports=function(e){if(/^\\x/.test(e))return new Buffer(e.substr(2),"hex");for(var r="",n=0;n<e.length;)if(e[n]!=="\\")r+=e[n],++n;else if(/[0-7]{3}/.test(e.substr(n+1,3)))r+=String.fromCharCode(parseInt(e.substr(n+1,3),8)),n+=4;else{for(var i=1;n+i<e.length&&e[n+i]==="\\";)i++;for(var s=0;s<Math.floor(i/2);++s)r+="\\";n+=Math.floor(i/2)*2}return new Buffer(r,"binary")}});var Rr=h((Gl,Er)=>{var ue=rt(),le=nt(),Pe=fr(),gr=yr(),vr=mr();function Ae(t){return function(r){return r===null?r:t(r)}}function br(t){return t===null?t:t==="TRUE"||t==="t"||t==="true"||t==="y"||t==="yes"||t==="on"||t==="1"}function qs(t){return t?ue.parse(t,br):null}function Ds(t){return parseInt(t,10)}function at(t){return t?ue.parse(t,Ae(Ds)):null}function Ls(t){return t?ue.parse(t,Ae(function(e){return wr(e).trim()})):null}var ks=function(t){if(!t)return null;var e=le.create(t,function(r){return r!==null&&(r=ft(r)),r});return e.parse()},ot=function(t){if(!t)return null;var e=le.create(t,function(r){return r!==null&&(r=parseFloat(r)),r});return e.parse()},A=function(t){if(!t)return null;var e=le.create(t);return e.parse()},ut=function(t){if(!t)return null;var e=le.create(t,function(r){return r!==null&&(r=Pe(r)),r});return e.parse()},Ns=function(t){if(!t)return null;var e=le.create(t,function(r){return r!==null&&(r=gr(r)),r});return e.parse()},Bs=function(t){return t?ue.parse(t,Ae(vr)):null},lt=function(t){return parseInt(t,10)},wr=function(t){var e=String(t);return/^\d+$/.test(e)?e:t},Sr=function(t){return t?ue.parse(t,Ae(JSON.parse)):null},ft=function(t){return t[0]!=="("?null:(t=t.substring(1,t.length-1).split(","),{x:parseFloat(t[0]),y:parseFloat(t[1])})},Fs=function(t){if(t[0]!=="<"&&t[1]!=="(")return null;for(var e="(",r="",n=!1,i=2;i<t.length-1;i++){if(n||(e+=t[i]),t[i]===")"){n=!0;continue}else if(!n)continue;t[i]!==","&&(r+=t[i])}var s=ft(e);return s.radius=parseFloat(r),s},Qs=function(t){t(20,wr),t(21,lt),t(23,lt),t(26,lt),t(700,parseFloat),t(701,parseFloat),t(16,br),t(1082,Pe),t(1114,Pe),t(1184,Pe),t(600,ft),t(651,A),t(718,Fs),t(1e3,qs),t(1001,Bs),t(1005,at),t(1007,at),t(1028,at),t(1016,Ls),t(1017,ks),t(1021,ot),t(1022,ot),t(1231,ot),t(1014,A),t(1015,A),t(1008,A),t(1009,A),t(1040,A),t(1041,A),t(1115,ut),t(1182,ut),t(1185,ut),t(1186,gr),t(1187,Ns),t(17,vr),t(114,JSON.parse.bind(JSON)),t(3802,JSON.parse.bind(JSON)),t(199,Sr),t(3807,Sr),t(3907,A),t(2951,A),t(791,A),t(1183,A),t(1270,A)};Er.exports={init:Qs}});var Mr=h((Hl,Tr)=>{"use strict";var T=1e6;function js(t){var e=t.readInt32BE(0),r=t.readUInt32BE(4),n="";e<0&&(e=~e+(r===0),r=~r+1>>>0,n="-");var i="",s,a,o,u,l,f;{if(s=e%T,e=e/T>>>0,a=4294967296*s+r,r=a/T>>>0,o=""+(a-T*r),r===0&&e===0)return n+o+i;for(u="",l=6-o.length,f=0;f<l;f++)u+="0";i=u+o+i}{if(s=e%T,e=e/T>>>0,a=4294967296*s+r,r=a/T>>>0,o=""+(a-T*r),r===0&&e===0)return n+o+i;for(u="",l=6-o.length,f=0;f<l;f++)u+="0";i=u+o+i}{if(s=e%T,e=e/T>>>0,a=4294967296*s+r,r=a/T>>>0,o=""+(a-T*r),r===0&&e===0)return n+o+i;for(u="",l=6-o.length,f=0;f<l;f++)u+="0";i=u+o+i}return s=e%T,a=4294967296*s+r,o=""+a%T,n+o+i}Tr.exports=js});var Or=h((Vl,xr)=>{var Us=Mr(),g=function(t,e,r,n,i){r=r||0,n=n||!1,i=i||function(m,R,q){return m*Math.pow(2,q)+R};var s=r>>3,a=function(m){return n?~m&255:m},o=255,u=8-r%8;e<u&&(o=255<<8-e&255,u=e),r&&(o=o>>r%8);var l=0;r%8+e>=8&&(l=i(0,a(t[s])&o,u));for(var f=e+r>>3,c=s+1;c<f;c++)l=i(l,a(t[c]),8);var y=(e+r)%8;return y>0&&(l=i(l,a(t[f])>>8-y,y)),l},Pr=function(t,e,r){var n=Math.pow(2,r-1)-1,i=g(t,1),s=g(t,r,1);if(s===0)return 0;var a=1,o=function(l,f,c){l===0&&(l=1);for(var y=1;y<=c;y++)a/=2,(f&1<<c-y)>0&&(l+=a);return l},u=g(t,e,r+1,!1,o);return s==Math.pow(2,r+1)-1?u===0?i===0?1/0:-1/0:NaN:(i===0?1:-1)*Math.pow(2,s-n)*u},Ws=function(t){return g(t,1)==1?-1*(g(t,15,1,!0)+1):g(t,15,1)},Ar=function(t){return g(t,1)==1?-1*(g(t,31,1,!0)+1):g(t,31,1)},Gs=function(t){return Pr(t,23,8)},Hs=function(t){return Pr(t,52,11)},Vs=function(t){var e=g(t,16,32);if(e==49152)return NaN;for(var r=Math.pow(1e4,g(t,16,16)),n=0,i=[],s=g(t,16),a=0;a<s;a++)n+=g(t,16,64+16*a)*r,r/=1e4;var o=Math.pow(10,g(t,16,48));return(e===0?1:-1)*Math.round(n*o)/o},Cr=function(t,e){var r=g(e,1),n=g(e,63,1),i=new Date((r===0?1:-1)*n/1e3+9466848e5);return t||i.setTime(i.getTime()+i.getTimezoneOffset()*6e4),i.usec=n%1e3,i.getMicroSeconds=function(){return this.usec},i.setMicroSeconds=function(s){this.usec=s},i.getUTCMicroSeconds=function(){return this.usec},i},fe=function(t){for(var e=g(t,32),r=g(t,32,32),n=g(t,32,64),i=96,s=[],a=0;a<e;a++)s[a]=g(t,32,i),i+=32,i+=32;var o=function(l){var f=g(t,32,i);if(i+=32,f==4294967295)return null;var c;if(l==23||l==20)return c=g(t,f*8,i),i+=f*8,c;if(l==25)return c=t.toString(this.encoding,i>>3,(i+=f<<3)>>3),c;console.log("ERROR: ElementType not implemented: "+l)},u=function(l,f){var c=[],y;if(l.length>1){var m=l.shift();for(y=0;y<m;y++)c[y]=u(l,f);l.unshift(m)}else for(y=0;y<l[0];y++)c[y]=o(f);return c};return u(s,n)},$s=function(t){return t.toString("utf8")},Ys=function(t){return t===null?null:g(t,8)>0},Ks=function(t){t(20,Us),t(21,Ws),t(23,Ar),t(26,Ar),t(1700,Vs),t(700,Gs),t(701,Hs),t(16,Ys),t(1114,Cr.bind(null,!1)),t(1184,Cr.bind(null,!0)),t(1e3,fe),t(1007,fe),t(1016,fe),t(1008,fe),t(1009,fe),t(25,$s)};xr.exports={init:Ks}});var qr=h(($l,Ir)=>{Ir.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var de=h(ce=>{var zs=Rr(),Zs=Or(),Js=nt(),Xs=qr();ce.getTypeParser=ea;ce.setTypeParser=ta;ce.arrayParser=Js;ce.builtins=Xs;var he={text:{},binary:{}};function Dr(t){return String(t)}function ea(t,e){return e=e||"text",he[e]&&he[e][t]||Dr}function ta(t,e,r){typeof e=="function"&&(r=e,e="text"),he[e][t]=r}zs.init(function(t,e){he.text[t]=e});Zs.init(function(t,e){he.binary[t]=e})});var pe=h((Kl,ht)=>{"use strict";ht.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var z=de(),ra=z.getTypeParser(20,"text"),na=z.getTypeParser(1016,"text");ht.exports.__defineSetter__("parseInt8",function(t){z.setTypeParser(20,"text",t?z.getTypeParser(23,"text"):ra),z.setTypeParser(1016,"text",t?z.getTypeParser(1007,"text"):na)})});var xe=h((zl,kr)=>{"use strict";var ia=require("crypto"),sa=pe();function aa(t){var e=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}function Lr(t){for(var e="{",r=0;r<t.length;r++)r>0&&(e=e+","),t[r]===null||typeof t[r]=="undefined"?e=e+"NULL":Array.isArray(t[r])?e=e+Lr(t[r]):t[r]instanceof Buffer?e+="\\\\x"+t[r].toString("hex"):e+=aa(Ce(t[r]));return e=e+"}",e}var Ce=function(t,e){if(t==null)return null;if(t instanceof Buffer)return t;if(ArrayBuffer.isView(t)){var r=Buffer.from(t.buffer,t.byteOffset,t.byteLength);return r.length===t.byteLength?r:r.slice(t.byteOffset,t.byteOffset+t.byteLength)}return t instanceof Date?sa.parseInputDatesAsUTC?la(t):ua(t):Array.isArray(t)?Lr(t):typeof t=="object"?oa(t,e):t.toString()};function oa(t,e){if(t&&typeof t.toPostgres=="function"){if(e=e||[],e.indexOf(t)!==-1)throw new Error('circular reference detected while preparing "'+t+'" for query');return e.push(t),Ce(t.toPostgres(Ce),e)}return JSON.stringify(t)}function E(t,e){for(t=""+t;t.length<e;)t="0"+t;return t}function ua(t){var e=-t.getTimezoneOffset(),r=t.getFullYear(),n=r<1;n&&(r=Math.abs(r)+1);var i=E(r,4)+"-"+E(t.getMonth()+1,2)+"-"+E(t.getDate(),2)+"T"+E(t.getHours(),2)+":"+E(t.getMinutes(),2)+":"+E(t.getSeconds(),2)+"."+E(t.getMilliseconds(),3);return e<0?(i+="-",e*=-1):i+="+",i+=E(Math.floor(e/60),2)+":"+E(e%60,2),n&&(i+=" BC"),i}function la(t){var e=t.getUTCFullYear(),r=e<1;r&&(e=Math.abs(e)+1);var n=E(e,4)+"-"+E(t.getUTCMonth()+1,2)+"-"+E(t.getUTCDate(),2)+"T"+E(t.getUTCHours(),2)+":"+E(t.getUTCMinutes(),2)+":"+E(t.getUTCSeconds(),2)+"."+E(t.getUTCMilliseconds(),3);return n+="+00:00",r&&(n+=" BC"),n}function fa(t,e,r){return t=typeof t=="string"?{text:t}:t,e&&(typeof e=="function"?t.callback=e:t.values=e),r&&(t.callback=r),t}var ct=function(t){return ia.createHash("md5").update(t,"utf-8").digest("hex")},ha=function(t,e,r){var n=ct(e+t),i=ct(Buffer.concat([Buffer.from(n),r]));return"md5"+i};kr.exports={prepareValue:function(e){return Ce(e)},normalizeQueryConfig:fa,postgresMd5PasswordHash:ha,md5:ct}});var jr=h((Zl,Qr)=>{"use strict";var dt=require("crypto");function ca(t){if(t.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let e=dt.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:e,response:"n,,n=*,r="+e,message:"SASLInitialResponse"}}function da(t,e,r){if(t.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof r!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let n=_a(r);if(n.nonce.startsWith(t.clientNonce)){if(n.nonce.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var i=Buffer.from(n.salt,"base64"),s=va(e,i,n.iteration),a=Z(s,"Client Key"),o=ga(a),u="n=*,r="+t.clientNonce,l="r="+n.nonce+",s="+n.salt+",i="+n.iteration,f="c=biws,r="+n.nonce,c=u+","+l+","+f,y=Z(o,c),m=Fr(a,y),R=m.toString("base64"),q=Z(s,"Server Key"),k=Z(q,c);t.message="SASLResponse",t.serverSignature=k.toString("base64"),t.response=f+",p="+R}function pa(t,e){if(t.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:r}=ma(e);if(r!==t.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function ya(t){if(typeof t!="string")throw new TypeError("SASL: text must be a string");return t.split("").map((e,r)=>t.charCodeAt(r)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function Nr(t){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(t)}function Br(t){if(typeof t!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(t.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let r=e[0],n=e.substring(2);return[r,n]}))}function _a(t){let e=Br(t),r=e.get("r");if(r){if(!ya(r))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let n=e.get("s");if(n){if(!Nr(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let i=e.get("i");if(i){if(!/^[1-9][0-9]*$/.test(i))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let s=parseInt(i,10);return{nonce:r,salt:n,iteration:s}}function ma(t){let r=Br(t).get("v");if(r){if(!Nr(r))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:r}}function Fr(t,e){if(!Buffer.isBuffer(t))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(t.length!==e.length)throw new Error("Buffer lengths must match");if(t.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(t.map((r,n)=>t[n]^e[n]))}function ga(t){return dt.createHash("sha256").update(t).digest()}function Z(t,e){return dt.createHmac("sha256",t).update(e).digest()}function va(t,e,r){for(var n=Z(t,Buffer.concat([e,Buffer.from([0,0,0,1])])),i=n,s=0;s<r-1;s++)n=Z(t,n),i=Fr(i,n);return i}Qr.exports={startSession:ca,continueSession:da,finalizeSession:pa}});var pt=h((Jl,Ur)=>{Ur.exports=require("stream")});var Vr=h((Xl,Hr)=>{"use strict";function Wr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ba(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wr(Object(r),!0).forEach(function(n){wa(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wa(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ea(t,e,r){return e&&Gr(t.prototype,e),r&&Gr(t,r),t}var Ra=require("buffer"),Oe=Ra.Buffer,Ta=require("util"),yt=Ta.inspect,Ma=yt&&yt.custom||"inspect";function Pa(t,e,r){Oe.prototype.copy.call(t,e,r)}Hr.exports=function(){function t(){Sa(this,t),this.head=null,this.tail=null,this.length=0}return Ea(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return Oe.alloc(0);for(var n=Oe.allocUnsafe(r>>>0),i=this.head,s=0;i;)Pa(i.data,n,s),s+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,s=n.data;for(r-=s.length;n=n.next;){var a=n.data,o=r>a.length?a.length:r;if(o===a.length?s+=a:s+=a.slice(0,r),r-=o,r===0){o===a.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=a.slice(o));break}++i}return this.length-=i,s}},{key:"_getBuffer",value:function(r){var n=Oe.allocUnsafe(r),i=this.head,s=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var a=i.data,o=r>a.length?a.length:r;if(a.copy(n,n.length-r,0,o),r-=o,r===0){o===a.length?(++s,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=a.slice(o));break}++s}return this.length-=s,n}},{key:Ma,value:function(r,n){return yt(this,ba({},n,{depth:0,customInspect:!1}))}}]),t}()});var mt=h((ef,Yr)=>{"use strict";function Aa(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(_t,this,t)):process.nextTick(_t,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(Ie,r):(r._writableState.errorEmitted=!0,process.nextTick($r,r,s)):process.nextTick($r,r,s):e?(process.nextTick(Ie,r),e(s)):process.nextTick(Ie,r)}),this)}function $r(t,e){_t(t,e),Ie(t)}function Ie(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function Ca(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function _t(t,e){t.emit("error",e)}function xa(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}Yr.exports={destroy:Aa,undestroy:Ca,errorOrDestroy:xa}});var N=h((tf,Zr)=>{"use strict";var Kr={};function C(t,e,r){r||(r=Error);function n(s,a,o){return typeof e=="string"?e:e(s,a,o)}class i extends r{constructor(a,o,u){super(n(a,o,u))}}i.prototype.name=r.name,i.prototype.code=t,Kr[t]=i}function zr(t,e){if(Array.isArray(t)){let r=t.length;return t=t.map(n=>String(n)),r>2?`one of ${e} ${t.slice(0,r-1).join(", ")}, or `+t[r-1]:r===2?`one of ${e} ${t[0]} or ${t[1]}`:`of ${e} ${t[0]}`}else return`of ${e} ${String(t)}`}function Oa(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function Ia(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function qa(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}C("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);C("ERR_INVALID_ARG_TYPE",function(t,e,r){let n;typeof e=="string"&&Oa(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";let i;if(Ia(t," argument"))i=`The ${t} ${n} ${zr(e,"type")}`;else{let s=qa(t,".")?"property":"argument";i=`The "${t}" ${s} ${n} ${zr(e,"type")}`}return i+=`. Received type ${typeof r}`,i},TypeError);C("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");C("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});C("ERR_STREAM_PREMATURE_CLOSE","Premature close");C("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});C("ERR_MULTIPLE_CALLBACK","Callback called multiple times");C("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");C("ERR_STREAM_WRITE_AFTER_END","write after end");C("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);C("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);C("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Zr.exports.codes=Kr});var gt=h((rf,Jr)=>{"use strict";var Da=N().codes.ERR_INVALID_OPT_VALUE;function La(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function ka(t,e,r,n){var i=La(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var s=n?r:"highWaterMark";throw new Da(s,i)}return Math.floor(i)}return t.objectMode?16:16*1024}Jr.exports={getHighWaterMark:ka}});var Xr=h((nf,vt)=>{typeof Object.create=="function"?vt.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:vt.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var J=h((sf,wt)=>{try{if(bt=require("util"),typeof bt.inherits!="function")throw"";wt.exports=bt.inherits}catch(t){wt.exports=Xr()}var bt});var tn=h((af,en)=>{en.exports=require("util").deprecate});var Rt=h((of,un)=>{"use strict";un.exports=b;function rn(t){var e=this;this.next=null,this.entry=null,this.finish=function(){lo(e,t)}}var X;b.WritableState=ye;var Na={deprecate:tn()},nn=pt(),qe=require("buffer").Buffer,Ba=global.Uint8Array||function(){};function Fa(t){return qe.from(t)}function Qa(t){return qe.isBuffer(t)||t instanceof Ba}var St=mt(),ja=gt(),Ua=ja.getHighWaterMark,B=N().codes,Wa=B.ERR_INVALID_ARG_TYPE,Ga=B.ERR_METHOD_NOT_IMPLEMENTED,Ha=B.ERR_MULTIPLE_CALLBACK,Va=B.ERR_STREAM_CANNOT_PIPE,$a=B.ERR_STREAM_DESTROYED,Ya=B.ERR_STREAM_NULL_VALUES,Ka=B.ERR_STREAM_WRITE_AFTER_END,za=B.ERR_UNKNOWN_ENCODING,ee=St.errorOrDestroy;J()(b,nn);function Za(){}function ye(t,e,r){X=X||G(),t=t||{},typeof r!="boolean"&&(r=e instanceof X),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=Ua(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){io(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new rn(this)}ye.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(ye.prototype,"buffer",{get:Na.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}})();var De;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(De=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(e){return De.call(this,e)?!0:this!==b?!1:e&&e._writableState instanceof ye}})):De=function(e){return e instanceof this};function b(t){X=X||G();var e=this instanceof X;if(!e&&!De.call(b,this))return new b(t);this._writableState=new ye(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),nn.call(this)}b.prototype.pipe=function(){ee(this,new Va)};function Ja(t,e){var r=new Ka;ee(t,r),process.nextTick(e,r)}function Xa(t,e,r,n){var i;return r===null?i=new Ya:typeof r!="string"&&!e.objectMode&&(i=new Wa("chunk",["string","Buffer"],r)),i?(ee(t,i),process.nextTick(n,i),!1):!0}b.prototype.write=function(t,e,r){var n=this._writableState,i=!1,s=!n.objectMode&&Qa(t);return s&&!qe.isBuffer(t)&&(t=Fa(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=Za),n.ending?Ja(this,r):(s||Xa(this,n,t,r))&&(n.pendingcb++,i=to(this,n,s,t,e,r)),i};b.prototype.cork=function(){this._writableState.corked++};b.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&an(this,t))};b.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new za(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(b.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function eo(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=qe.from(e,r)),e}Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function to(t,e,r,n,i,s){if(!r){var a=eo(e,n,i);n!==a&&(r=!0,i="buffer",n=a)}var o=e.objectMode?1:n.length;e.length+=o;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Et(t,e,!1,o,n,i,s);return u}function Et(t,e,r,n,i,s,a){e.writelen=n,e.writecb=a,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new $a("write")):r?t._writev(i,e.onwrite):t._write(i,s,e.onwrite),e.sync=!1}function ro(t,e,r,n,i){--e.pendingcb,r?(process.nextTick(i,n),process.nextTick(_e,t,e),t._writableState.errorEmitted=!0,ee(t,n)):(i(n),t._writableState.errorEmitted=!0,ee(t,n),_e(t,e))}function no(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function io(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new Ha;if(no(r),e)ro(t,r,n,e,i);else{var s=on(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&an(t,r),n?process.nextTick(sn,t,r,s,i):sn(t,r,s,i)}}function sn(t,e,r,n){r||so(t,e),e.pendingcb--,n(),_e(t,e)}function so(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function an(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),s=e.corkedRequestsFree;s.entry=r;for(var a=0,o=!0;r;)i[a]=r,r.isBuf||(o=!1),r=r.next,a+=1;i.allBuffers=o,Et(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new rn(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,f=r.callback,c=e.objectMode?1:u.length;if(Et(t,e,!1,c,u,l,f),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}b.prototype._write=function(t,e,r){r(new Ga("_write()"))};b.prototype._writev=null;b.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||uo(this,n,r),this};Object.defineProperty(b.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function on(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function ao(t,e){t._final(function(r){e.pendingcb--,r&&ee(t,r),e.prefinished=!0,t.emit("prefinish"),_e(t,e)})}function oo(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(ao,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function _e(t,e){var r=on(e);if(r&&(oo(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function uo(t,e,r){e.ending=!0,_e(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function lo(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});b.prototype.destroy=St.destroy;b.prototype._undestroy=St.undestroy;b.prototype._destroy=function(t,e){e(t)}});var G=h((uf,fn)=>{"use strict";var fo=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};fn.exports=I;var ln=Pt(),Tt=Rt();J()(I,ln);for(Mt=fo(Tt.prototype),Le=0;Le<Mt.length;Le++)ke=Mt[Le],I.prototype[ke]||(I.prototype[ke]=Tt.prototype[ke]);var Mt,ke,Le;function I(t){if(!(this instanceof I))return new I(t);ln.call(this,t),Tt.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",ho)))}Object.defineProperty(I.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(I.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(I.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ho(){this._writableState.ended||process.nextTick(co,this)}function co(t){t.end()}Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var Ne=h((lf,dn)=>{"use strict";var hn=N().codes.ERR_STREAM_PREMATURE_CLOSE;function po(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}function yo(){}function _o(t){return t.setHeader&&typeof t.abort=="function"}function cn(t,e,r){if(typeof e=="function")return cn(t,null,e);e||(e={}),r=po(r||yo);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||o()},a=t._writableState&&t._writableState.finished,o=function(){i=!1,a=!0,n||r.call(t)},u=t._readableState&&t._readableState.endEmitted,l=function(){n=!1,u=!0,i||r.call(t)},f=function(R){r.call(t,R)},c=function(){var R;if(n&&!u)return(!t._readableState||!t._readableState.ended)&&(R=new hn),r.call(t,R);if(i&&!a)return(!t._writableState||!t._writableState.ended)&&(R=new hn),r.call(t,R)},y=function(){t.req.on("finish",o)};return _o(t)?(t.on("complete",o),t.on("abort",c),t.req?y():t.on("request",y)):i&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",l),t.on("finish",o),e.error!==!1&&t.on("error",f),t.on("close",c),function(){t.removeListener("complete",o),t.removeListener("abort",c),t.removeListener("request",y),t.req&&t.req.removeListener("finish",o),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",o),t.removeListener("end",l),t.removeListener("error",f),t.removeListener("close",c)}}dn.exports=cn});var yn=h((ff,pn)=>{"use strict";var Be;function F(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mo=Ne(),Q=Symbol("lastResolve"),H=Symbol("lastReject"),me=Symbol("error"),Fe=Symbol("ended"),V=Symbol("lastPromise"),At=Symbol("handlePromise"),$=Symbol("stream");function j(t,e){return{value:t,done:e}}function go(t){var e=t[Q];if(e!==null){var r=t[$].read();r!==null&&(t[V]=null,t[Q]=null,t[H]=null,e(j(r,!1)))}}function vo(t){process.nextTick(go,t)}function bo(t,e){return function(r,n){t.then(function(){if(e[Fe]){r(j(void 0,!0));return}e[At](r,n)},n)}}var wo=Object.getPrototypeOf(function(){}),So=Object.setPrototypeOf((Be={get stream(){return this[$]},next:function(){var e=this,r=this[me];if(r!==null)return Promise.reject(r);if(this[Fe])return Promise.resolve(j(void 0,!0));if(this[$].destroyed)return new Promise(function(a,o){process.nextTick(function(){e[me]?o(e[me]):a(j(void 0,!0))})});var n=this[V],i;if(n)i=new Promise(bo(n,this));else{var s=this[$].read();if(s!==null)return Promise.resolve(j(s,!1));i=new Promise(this[At])}return this[V]=i,i}},F(Be,Symbol.asyncIterator,function(){return this}),F(Be,"return",function(){var e=this;return new Promise(function(r,n){e[$].destroy(null,function(i){if(i){n(i);return}r(j(void 0,!0))})})}),Be),wo),Eo=function(e){var r,n=Object.create(So,(r={},F(r,$,{value:e,writable:!0}),F(r,Q,{value:null,writable:!0}),F(r,H,{value:null,writable:!0}),F(r,me,{value:null,writable:!0}),F(r,Fe,{value:e._readableState.endEmitted,writable:!0}),F(r,At,{value:function(s,a){var o=n[$].read();o?(n[V]=null,n[Q]=null,n[H]=null,s(j(o,!1))):(n[Q]=s,n[H]=a)},writable:!0}),r));return n[V]=null,mo(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=n[H];s!==null&&(n[V]=null,n[Q]=null,n[H]=null,s(i)),n[me]=i;return}var a=n[Q];a!==null&&(n[V]=null,n[Q]=null,n[H]=null,a(j(void 0,!0))),n[Fe]=!0}),e.on("readable",vo.bind(null,n)),n};pn.exports=Eo});var vn=h((hf,gn)=>{"use strict";function _n(t,e,r,n,i,s,a){try{var o=t[s](a),u=o.value}catch(l){r(l);return}o.done?e(u):Promise.resolve(u).then(n,i)}function Ro(t){return function(){var e=this,r=arguments;return new Promise(function(n,i){var s=t.apply(e,r);function a(u){_n(s,n,i,a,o,"next",u)}function o(u){_n(s,n,i,a,o,"throw",u)}a(void 0)})}}function mn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function To(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mn(Object(r),!0).forEach(function(n){Mo(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mn(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Po=N().codes.ERR_INVALID_ARG_TYPE;function Ao(t,e,r){var n;if(e&&typeof e.next=="function")n=e;else if(e&&e[Symbol.asyncIterator])n=e[Symbol.asyncIterator]();else if(e&&e[Symbol.iterator])n=e[Symbol.iterator]();else throw new Po("iterable",["Iterable"],e);var i=new t(To({objectMode:!0},r)),s=!1;i._read=function(){s||(s=!0,a())};function a(){return o.apply(this,arguments)}function o(){return o=Ro(function*(){try{var u=yield n.next(),l=u.value,f=u.done;f?i.push(null):i.push(yield l)?a():s=!1}catch(c){i.destroy(c)}}),o.apply(this,arguments)}return i}gn.exports=Ao});var Pt=h((df,Cn)=>{"use strict";Cn.exports=_;var te;_.ReadableState=wn;var cf=require("events").EventEmitter,bn=function(e,r){return e.listeners(r).length},ge=pt(),Qe=require("buffer").Buffer,Co=global.Uint8Array||function(){};function xo(t){return Qe.from(t)}function Oo(t){return Qe.isBuffer(t)||t instanceof Co}var Ct=require("util"),p;Ct&&Ct.debuglog?p=Ct.debuglog("stream"):p=function(){};var Io=Vr(),xt=mt(),qo=gt(),Do=qo.getHighWaterMark,je=N().codes,Lo=je.ERR_INVALID_ARG_TYPE,ko=je.ERR_STREAM_PUSH_AFTER_EOF,No=je.ERR_METHOD_NOT_IMPLEMENTED,Bo=je.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,re,Ot,It;J()(_,ge);var ve=xt.errorOrDestroy,qt=["error","close","destroy","pause","resume"];function Fo(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function wn(t,e,r){te=te||G(),t=t||{},typeof r!="boolean"&&(r=e instanceof te),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=Do(this,t,"readableHighWaterMark",r),this.buffer=new Io,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(re||(re=require("string_decoder/").StringDecoder),this.decoder=new re(t.encoding),this.encoding=t.encoding)}function _(t){if(te=te||G(),!(this instanceof _))return new _(t);var e=this instanceof te;this._readableState=new wn(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),ge.call(this)}Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});_.prototype.destroy=xt.destroy;_.prototype._undestroy=xt.undestroy;_.prototype._destroy=function(t,e){e(t)};_.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=Qe.from(t,e),e=""),n=!0),Sn(this,t,e,!1,n)};_.prototype.unshift=function(t){return Sn(this,t,null,!0,!1)};function Sn(t,e,r,n,i){p("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,Uo(t,s);else{var a;if(i||(a=Qo(s,e)),a)ve(t,a);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==Qe.prototype&&(e=xo(e)),n)s.endEmitted?ve(t,new Bo):Dt(t,s,e,!0);else if(s.ended)ve(t,new ko);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?Dt(t,s,e,!1):Lt(t,s)):Dt(t,s,e,!1)}else n||(s.reading=!1,Lt(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function Dt(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Ue(t)),Lt(t,e)}function Qo(t,e){var r;return!Oo(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new Lo("chunk",["string","Buffer","Uint8Array"],e)),r}_.prototype.isPaused=function(){return this._readableState.flowing===!1};_.prototype.setEncoding=function(t){re||(re=require("string_decoder/").StringDecoder);var e=new re(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var En=1073741824;function jo(t){return t>=En?t=En:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function Rn(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=jo(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}_.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return p("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Nt(this):Ue(this),null;if(t=Rn(t,e),t===0&&e.ended)return e.length===0&&Nt(this),null;var n=e.needReadable;p("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,p("length less than watermark",n)),e.ended||e.reading?(n=!1,p("reading or ended",n)):n&&(p("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Rn(r,e)));var i;return t>0?i=Pn(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&Nt(this)),i!==null&&this.emit("data",i),i};function Uo(t,e){if(p("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?Ue(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Tn(t)))}}function Ue(t){var e=t._readableState;p("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Tn,t))}function Tn(t){var e=t._readableState;p("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,kt(t)}function Lt(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(Wo,t,e))}function Wo(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(p("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}_.prototype._read=function(t){ve(this,new No("_read()"))};_.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,p("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=i?o:q;n.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",a);function a(k,Y){p("onunpipe"),k===r&&Y&&Y.hasUnpiped===!1&&(Y.hasUnpiped=!0,f())}function o(){p("onend"),t.end()}var u=Go(r);t.on("drain",u);var l=!1;function f(){p("cleanup"),t.removeListener("close",m),t.removeListener("finish",R),t.removeListener("drain",u),t.removeListener("error",y),t.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",q),r.removeListener("data",c),l=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&u()}r.on("data",c);function c(k){p("ondata");var Y=t.write(k);p("dest.write",Y),Y===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&An(n.pipes,t)!==-1)&&!l&&(p("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function y(k){p("onerror",k),q(),t.removeListener("error",y),bn(t,"error")===0&&ve(t,k)}Fo(t,"error",y);function m(){t.removeListener("finish",R),q()}t.once("close",m);function R(){p("onfinish"),t.removeListener("close",m),q()}t.once("finish",R);function q(){p("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(p("pipe resume"),r.resume()),t};function Go(t){return function(){var r=t._readableState;p("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&bn(t,"data")&&(r.flowing=!0,kt(t))}}_.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=An(e.pipes,t);return a===-1?this:(e.pipes.splice(a,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};_.prototype.on=function(t,e){var r=ge.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,p("on readable",n.length,n.reading),n.length?Ue(this):n.reading||process.nextTick(Ho,this)),r};_.prototype.addListener=_.prototype.on;_.prototype.removeListener=function(t,e){var r=ge.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(Mn,this),r};_.prototype.removeAllListeners=function(t){var e=ge.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(Mn,this),e};function Mn(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function Ho(t){p("readable nexttick read 0"),t.read(0)}_.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!t.readableListening,Vo(this,t)),t.paused=!1,this};function Vo(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick($o,t,e))}function $o(t,e){p("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),kt(t),e.flowing&&!e.reading&&t.read(0)}_.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function kt(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&t.read()!==null;);}_.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(p("wrapped end"),r.decoder&&!r.ended){var a=r.decoder.end();a&&a.length&&e.push(a)}e.push(null)}),t.on("data",function(a){if(p("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!(r.objectMode&&a==null)&&!(!r.objectMode&&(!a||!a.length))){var o=e.push(a);o||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(o){return function(){return t[o].apply(t,arguments)}}(i));for(var s=0;s<qt.length;s++)t.on(qt[s],this.emit.bind(this,qt[s]));return this._read=function(a){p("wrapped _read",a),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(_.prototype[Symbol.asyncIterator]=function(){return Ot===void 0&&(Ot=yn()),Ot(this)});Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(_.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(_.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});_._fromList=Pn;Object.defineProperty(_.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Pn(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function Nt(t){var e=t._readableState;p("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(Yo,e,t))}function Yo(t,e){if(p("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(_.from=function(t,e){return It===void 0&&(It=vn()),It(_,t,e)});function An(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var Bt=h((pf,On)=>{"use strict";On.exports=D;var We=N().codes,Ko=We.ERR_METHOD_NOT_IMPLEMENTED,zo=We.ERR_MULTIPLE_CALLBACK,Zo=We.ERR_TRANSFORM_ALREADY_TRANSFORMING,Jo=We.ERR_TRANSFORM_WITH_LENGTH_0,Ge=G();J()(D,Ge);function Xo(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new zo);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function D(t){if(!(this instanceof D))return new D(t);Ge.call(this,t),this._transformState={afterTransform:Xo.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",eu)}function eu(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){xn(t,e,r)}):xn(this,null,null)}D.prototype.push=function(t,e){return this._transformState.needTransform=!1,Ge.prototype.push.call(this,t,e)};D.prototype._transform=function(t,e,r){r(new Ko("_transform()"))};D.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};D.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};D.prototype._destroy=function(t,e){Ge.prototype._destroy.call(this,t,function(r){e(r)})};function xn(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new Jo;if(t._transformState.transforming)throw new Zo;return t.push(null)}});var Dn=h((yf,qn)=>{"use strict";qn.exports=be;var In=Bt();J()(be,In);function be(t){if(!(this instanceof be))return new be(t);In.call(this,t)}be.prototype._transform=function(t,e,r){r(null,t)}});var Fn=h((_f,Bn)=>{"use strict";var Ft;function tu(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var Ln=N().codes,ru=Ln.ERR_MISSING_ARGS,nu=Ln.ERR_STREAM_DESTROYED;function kn(t){if(t)throw t}function iu(t){return t.setHeader&&typeof t.abort=="function"}function su(t,e,r,n){n=tu(n);var i=!1;t.on("close",function(){i=!0}),Ft===void 0&&(Ft=Ne()),Ft(t,{readable:e,writable:r},function(a){if(a)return n(a);i=!0,n()});var s=!1;return function(a){if(!i&&!s){if(s=!0,iu(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(a||new nu("pipe"))}}}function Nn(t){t()}function au(t,e){return t.pipe(e)}function ou(t){return!t.length||typeof t[t.length-1]!="function"?kn:t.pop()}function uu(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=ou(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new ru("streams");var i,s=e.map(function(a,o){var u=o<e.length-1,l=o>0;return su(a,u,l,function(f){i||(i=f),f&&s.forEach(Nn),!u&&(s.forEach(Nn),n(i))})});return e.reduce(au)}Bn.exports=uu});var Qn=h((x,Se)=>{var we=require("stream");process.env.READABLE_STREAM==="disable"&&we?(Se.exports=we.Readable,Object.assign(Se.exports,we),Se.exports.Stream=we):(x=Se.exports=Pt(),x.Stream=we||x,x.Readable=x,x.Writable=Rt(),x.Duplex=G(),x.Transform=Bt(),x.PassThrough=Dn(),x.finished=Ne(),x.pipeline=Fn())});var Gn=h((mf,Wn)=>{"use strict";var{Transform:lu}=Qn(),{StringDecoder:fu}=require("string_decoder"),U=Symbol("last"),He=Symbol("decoder");function hu(t,e,r){var n;if(this.overflow){var i=this[He].write(t);if(n=i.split(this.matcher),n.length===1)return r();n.shift(),this.overflow=!1}else this[U]+=this[He].write(t),n=this[U].split(this.matcher);this[U]=n.pop();for(var s=0;s<n.length;s++)try{jn(this,this.mapper(n[s]))}catch(a){return r(a)}if(this.overflow=this[U].length>this.maxLength,this.overflow&&!this.skipOverflow)return r(new Error("maximum buffer reached"));r()}function cu(t){if(this[U]+=this[He].end(),this[U])try{jn(this,this.mapper(this[U]))}catch(e){return t(e)}t()}function jn(t,e){e!==void 0&&t.push(e)}function Un(t){return t}function du(t,e,r){switch(t=t||/\r?\n/,e=e||Un,r=r||{},arguments.length){case 1:typeof t=="function"?(e=t,t=/\r?\n/):typeof t=="object"&&!(t instanceof RegExp)&&(r=t,t=/\r?\n/);break;case 2:typeof t=="function"?(r=e,e=t,t=/\r?\n/):typeof e=="object"&&(r=e,e=Un)}r=Object.assign({},r),r.transform=hu,r.flush=cu,r.readableObjectMode=!0;let n=new lu(r);return n[U]="",n[He]=new fu("utf8"),n.matcher=t,n.mapper=e,n.maxLength=r.maxLength,n.skipOverflow=r.skipOverflow,n.overflow=!1,n}Wn.exports=du});var $n=h((gf,L)=>{"use strict";var Hn=require("path"),pu=require("stream").Stream,yu=Gn(),Vn=require("util"),_u=5432,Ve=process.platform==="win32",Ee=process.stderr,mu=56,gu=7,vu=61440,bu=32768;function wu(t){return(t&vu)==bu}var ne=["host","port","database","user","password"],Qt=ne.length,Su=ne[Qt-1];function jt(){var t=Ee instanceof pu&&Ee.writable===!0;if(t){var e=Array.prototype.slice.call(arguments).concat(`
`);Ee.write(Vn.format.apply(Vn,e))}}Object.defineProperty(L.exports,"isWin",{get:function(){return Ve},set:function(t){Ve=t}});L.exports.warnTo=function(t){var e=Ee;return Ee=t,e};L.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(Ve?Hn.join(e.APPDATA||"./","postgresql","pgpass.conf"):Hn.join(e.HOME||"./",".pgpass"));return r};L.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Ve?!0:(e=e||"<unkn>",wu(t.mode)?t.mode&(mu|gu)?(jt('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(jt('WARNING: password file "%s" is not a plain file',e),!1))};var Eu=L.exports.match=function(t,e){return ne.slice(0,-1).reduce(function(r,n,i){return i==1&&Number(t[n]||_u)===Number(e[n])?r&&!0:r&&(e[n]==="*"||e[n]===t[n])},!0)};L.exports.getPassword=function(t,e,r){var n,i=e.pipe(yu());function s(u){var l=Ru(u);l&&Tu(l)&&Eu(t,l)&&(n=l[Su],i.end())}var a=function(){e.destroy(),r(n)},o=function(u){e.destroy(),jt("WARNING: error on reading file: %s",u),r(void 0)};e.on("error",o),i.on("data",s).on("end",a).on("error",o)};var Ru=L.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",n=0,i=0,s=0,a={},o=!1,u=function(f,c,y){var m=t.substring(c,y);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),a[ne[f]]=m},l=0;l<t.length-1;l+=1){if(e=t.charAt(l+1),r=t.charAt(l),o=n==Qt-1,o){u(n,i);break}l>=0&&e==":"&&r!=="\\"&&(u(n,i,l+1),i=l+2,n+=1)}return a=Object.keys(a).length===Qt?a:null,a},Tu=L.exports.isValidEntry=function(t){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},r=0;r<ne.length;r+=1){var n=e[r],i=t[ne[r]]||"",s=n(i);if(!s)return!1}return!0}});var Kn=h((bf,Ut)=>{"use strict";var vf=require("path"),Yn=require("fs"),$e=$n();Ut.exports=function(t,e){var r=$e.getFileName();Yn.stat(r,function(n,i){if(n||!$e.usePgPass(i,r))return e(void 0);var s=Yn.createReadStream(r);$e.getPassword(t,s,e)})};Ut.exports.warnTo=$e.warnTo});var Wt=h((wf,zn)=>{"use strict";var Mu=de();function Ye(t){this._types=t||Mu,this.text={},this.binary={}}Ye.prototype.getOverrides=function(t){switch(t){case"text":return this.text;case"binary":return this.binary;default:return{}}};Ye.prototype.setTypeParser=function(t,e,r){typeof e=="function"&&(r=e,e="text"),this.getOverrides(e)[t]=r};Ye.prototype.getTypeParser=function(t,e){return e=e||"text",this.getOverrides(e)[t]||this._types.getTypeParser(t,e)};zn.exports=Ye});var Jn=h((Sf,Zn)=>{"use strict";var Pu=require("url"),Gt=require("fs");function Ht(t){if(t.charAt(0)==="/"){var r=t.split(" ");return{host:r[0],database:r[1]}}var e=Pu.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(t)?encodeURI(t).replace(/\%25(\d\d)/g,"%$1"):t,!0),r=e.query;for(var n in r)Array.isArray(r[n])&&(r[n]=r[n][r[n].length-1]);var i=(e.auth||":").split(":");if(r.user=i[0],r.password=i.splice(1).join(":"),r.port=e.port,e.protocol=="socket:")return r.host=decodeURI(e.pathname),r.database=e.query.db,r.client_encoding=e.query.encoding,r;r.host||(r.host=e.hostname);var s=e.pathname;if(!r.host&&s&&/^%2f/i.test(s)){var a=s.split("/");r.host=decodeURIComponent(a[0]),s=a.splice(1).join("/")}switch(s&&s.charAt(0)==="/"&&(s=s.slice(1)||null),r.database=s&&decodeURI(s),(r.ssl==="true"||r.ssl==="1")&&(r.ssl=!0),r.ssl==="0"&&(r.ssl=!1),(r.sslcert||r.sslkey||r.sslrootcert||r.sslmode)&&(r.ssl={}),r.sslcert&&(r.ssl.cert=Gt.readFileSync(r.sslcert).toString()),r.sslkey&&(r.ssl.key=Gt.readFileSync(r.sslkey).toString()),r.sslrootcert&&(r.ssl.ca=Gt.readFileSync(r.sslrootcert).toString()),r.sslmode){case"disable":{r.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{r.ssl.rejectUnauthorized=!1;break}}return r}Zn.exports=Ht;Ht.parse=Ht});var Vt=h((Ef,ri)=>{"use strict";var Au=require("dns"),Xn=pe(),ei=Jn().parse,M=function(t,e,r){return r===void 0?r=process.env["PG"+t.toUpperCase()]:r===!1||(r=process.env[r]),e[t]||r||Xn[t]},Cu=function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return Xn.ssl},ie=function(t){return"'"+(""+t).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},O=function(t,e,r){var n=e[r];n!=null&&t.push(r+"="+ie(n))},ti=class{constructor(e){e=typeof e=="string"?ei(e):e||{},e.connectionString&&(e=Object.assign({},e,ei(e.connectionString))),this.user=M("user",e),this.database=M("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(M("port",e),10),this.host=M("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:M("password",e)}),this.binary=M("binary",e),this.options=M("options",e),this.ssl=typeof e.ssl=="undefined"?Cu():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=M("client_encoding",e),this.replication=M("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=M("application_name",e,"PGAPPNAME"),this.fallback_application_name=M("fallback_application_name",e,!1),this.statement_timeout=M("statement_timeout",e,!1),this.idle_in_transaction_session_timeout=M("idle_in_transaction_session_timeout",e,!1),this.query_timeout=M("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var r=[];O(r,this,"user"),O(r,this,"password"),O(r,this,"port"),O(r,this,"application_name"),O(r,this,"fallback_application_name"),O(r,this,"connect_timeout"),O(r,this,"options");var n=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(O(r,n,"sslmode"),O(r,n,"sslca"),O(r,n,"sslkey"),O(r,n,"sslcert"),O(r,n,"sslrootcert"),this.database&&r.push("dbname="+ie(this.database)),this.replication&&r.push("replication="+ie(this.replication)),this.host&&r.push("host="+ie(this.host)),this.isDomainSocket)return e(null,r.join(" "));this.client_encoding&&r.push("client_encoding="+ie(this.client_encoding)),Au.lookup(this.host,function(i,s){return i?e(i,null):(r.push("hostaddr="+ie(s)),e(null,r.join(" ")))})}};ri.exports=ti});var ai=h((Rf,si)=>{"use strict";var xu=de(),ni=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,ii=class{constructor(e,r){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=r,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(e){var r;e.text?r=ni.exec(e.text):r=ni.exec(e.command),r&&(this.command=r[1],r[3]?(this.oid=parseInt(r[2],10),this.rowCount=parseInt(r[3],10)):r[2]&&(this.rowCount=parseInt(r[2],10)))}_parseRowAsArray(e){for(var r=new Array(e.length),n=0,i=e.length;n<i;n++){var s=e[n];s!==null?r[n]=this._parsers[n](s):r[n]=null}return r}parseRow(e){for(var r={},n=0,i=e.length;n<i;n++){var s=e[n],a=this.fields[n].name;s!==null?r[a]=this._parsers[n](s):r[a]=null}return r}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var r=0;r<e.length;r++){var n=e[r];this._types?this._parsers[r]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[r]=xu.getTypeParser(n.dataTypeID,n.format||"text")}}};si.exports=ii});var hi=h((Tf,fi)=>{"use strict";var{EventEmitter:Ou}=require("events"),oi=ai(),ui=xe(),li=class extends Ou{constructor(e,r,n){super();e=ui.normalizeQueryConfig(e,r,n),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,process.domain&&e.callback&&(this.callback=process.domain.bind(e.callback)),this._result=new oi(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new oi(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let r;if(!this._canceledDueToError){try{r=this._result.parseRow(e.fields)}catch(n){this._canceledDueToError=n;return}this.emit("row",r,this._result),this._accumulateRows&&this._result.addRow(r)}}handleCommandComplete(e,r){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&r.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,r){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);this.callback&&this.callback(null,this._results),this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let r=e.parsedStatements[this.name];return this.text&&r&&this.text!==r?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,r){e.execute({portal:this.portal,rows:r}),r?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:ui.prepareValue})}catch(r){this.handleError(r,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,r){}};fi.exports=li});var $t=h(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.NoticeMessage=d.DataRowMessage=d.CommandCompleteMessage=d.ReadyForQueryMessage=d.NotificationResponseMessage=d.BackendKeyDataMessage=d.AuthenticationMD5Password=d.ParameterStatusMessage=d.ParameterDescriptionMessage=d.RowDescriptionMessage=d.Field=d.CopyResponse=d.CopyDataMessage=d.DatabaseError=d.copyDone=d.emptyQuery=d.replicationStart=d.portalSuspended=d.noData=d.closeComplete=d.bindComplete=d.parseComplete=void 0;d.parseComplete={name:"parseComplete",length:5};d.bindComplete={name:"bindComplete",length:5};d.closeComplete={name:"closeComplete",length:5};d.noData={name:"noData",length:5};d.portalSuspended={name:"portalSuspended",length:5};d.replicationStart={name:"replicationStart",length:4};d.emptyQuery={name:"emptyQuery",length:4};d.copyDone={name:"copyDone",length:4};var ci=class extends Error{constructor(e,r,n){super(e);this.length=r,this.name=n}};d.DatabaseError=ci;var di=class{constructor(e,r){this.length=e,this.chunk=r,this.name="copyData"}};d.CopyDataMessage=di;var pi=class{constructor(e,r,n,i){this.length=e,this.name=r,this.binary=n,this.columnTypes=new Array(i)}};d.CopyResponse=pi;var yi=class{constructor(e,r,n,i,s,a,o){this.name=e,this.tableID=r,this.columnID=n,this.dataTypeID=i,this.dataTypeSize=s,this.dataTypeModifier=a,this.format=o}};d.Field=yi;var _i=class{constructor(e,r){this.length=e,this.fieldCount=r,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};d.RowDescriptionMessage=_i;var mi=class{constructor(e,r){this.length=e,this.parameterCount=r,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};d.ParameterDescriptionMessage=mi;var gi=class{constructor(e,r,n){this.length=e,this.parameterName=r,this.parameterValue=n,this.name="parameterStatus"}};d.ParameterStatusMessage=gi;var vi=class{constructor(e,r){this.length=e,this.salt=r,this.name="authenticationMD5Password"}};d.AuthenticationMD5Password=vi;var bi=class{constructor(e,r,n){this.length=e,this.processID=r,this.secretKey=n,this.name="backendKeyData"}};d.BackendKeyDataMessage=bi;var wi=class{constructor(e,r,n,i){this.length=e,this.processId=r,this.channel=n,this.payload=i,this.name="notification"}};d.NotificationResponseMessage=wi;var Si=class{constructor(e,r){this.length=e,this.status=r,this.name="readyForQuery"}};d.ReadyForQueryMessage=Si;var Ei=class{constructor(e,r){this.length=e,this.text=r,this.name="commandComplete"}};d.CommandCompleteMessage=Ei;var Ri=class{constructor(e,r){this.length=e,this.fields=r,this.name="dataRow",this.fieldCount=r.length}};d.DataRowMessage=Ri;var Ti=class{constructor(e,r){this.length=e,this.message=r,this.name="notice"}};d.NoticeMessage=Ti});var Pi=h(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.Writer=void 0;var Mi=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(e)}ensure(e){var r=this.buffer.length-this.offset;if(r<e){var n=this.buffer,i=n.length+(n.length>>1)+e;this.buffer=Buffer.allocUnsafe(i),n.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var r=Buffer.byteLength(e);this.ensure(r+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=r}return this.buffer[this.offset++]=0,this}addString(e=""){var r=Buffer.byteLength(e);return this.ensure(r),this.buffer.write(e,this.offset),this.offset+=r,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let r=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(r,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var r=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),r}};Ke.Writer=Mi});var Ci=h(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.serialize=void 0;var Yt=Pi(),v=new Yt.Writer,Iu=t=>{v.addInt16(3).addInt16(0);for(let n of Object.keys(t))v.addCString(n).addCString(t[n]);v.addCString("client_encoding").addCString("UTF8");var e=v.addCString("").flush(),r=e.length+4;return new Yt.Writer().addInt32(r).add(e).flush()},qu=()=>{let t=Buffer.allocUnsafe(8);return t.writeInt32BE(8,0),t.writeInt32BE(80877103,4),t},Du=t=>v.addCString(t).flush(112),Lu=function(t,e){return v.addCString(t).addInt32(Buffer.byteLength(e)).addString(e),v.flush(112)},ku=function(t){return v.addString(t).flush(112)},Nu=t=>v.addCString(t).flush(81),Ai=[],Bu=t=>{let e=t.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let r=t.types||Ai;for(var n=r.length,i=v.addCString(e).addCString(t.text).addInt16(n),s=0;s<n;s++)i.addInt32(r[s]);return v.flush(80)},se=new Yt.Writer,Fu=function(t,e){for(let r=0;r<t.length;r++){let n=e?e(t[r],r):t[r];n==null?(v.addInt16(0),se.addInt32(-1)):n instanceof Buffer?(v.addInt16(1),se.addInt32(n.length),se.add(n)):(v.addInt16(0),se.addInt32(Buffer.byteLength(n)),se.addString(n))}},Qu=(t={})=>{let e=t.portal||"",r=t.statement||"",n=t.binary||!1,i=t.values||Ai,s=i.length;return v.addCString(e).addCString(r),v.addInt16(s),Fu(i,t.valueMapper),v.addInt16(s),v.add(se.flush()),v.addInt16(n?1:0),v.flush(66)},ju=Buffer.from([69,0,0,0,9,0,0,0,0,0]),Uu=t=>{if(!t||!t.portal&&!t.rows)return ju;let e=t.portal||"",r=t.rows||0,n=Buffer.byteLength(e),i=4+n+1+4,s=Buffer.allocUnsafe(1+i);return s[0]=69,s.writeInt32BE(i,1),s.write(e,5,"utf-8"),s[n+5]=0,s.writeUInt32BE(r,s.length-4),s},Wu=(t,e)=>{let r=Buffer.allocUnsafe(16);return r.writeInt32BE(16,0),r.writeInt16BE(1234,4),r.writeInt16BE(5678,6),r.writeInt32BE(t,8),r.writeInt32BE(e,12),r},Kt=(t,e)=>{let r=Buffer.byteLength(e),n=4+r+1,i=Buffer.allocUnsafe(1+n);return i[0]=t,i.writeInt32BE(n,1),i.write(e,5,"utf-8"),i[n]=0,i},Gu=v.addCString("P").flush(68),Hu=v.addCString("S").flush(68),Vu=t=>t.name?Kt(68,`${t.type}${t.name||""}`):t.type==="P"?Gu:Hu,$u=t=>{let e=`${t.type}${t.name||""}`;return Kt(67,e)},Yu=t=>v.add(t).flush(100),Ku=t=>Kt(102,t),ze=t=>Buffer.from([t,0,0,0,4]),zu=ze(72),Zu=ze(83),Ju=ze(88),Xu=ze(99),el={startup:Iu,password:Du,requestSsl:qu,sendSASLInitialResponseMessage:Lu,sendSCRAMClientFinalMessage:ku,query:Nu,parse:Bu,bind:Qu,execute:Uu,describe:Vu,close:$u,flush:()=>zu,sync:()=>Zu,end:()=>Ju,copyData:Yu,copyDone:()=>Xu,copyFail:Ku,cancel:Wu};Ze.serialize=el});var Oi=h(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.BufferReader=void 0;var tl=Buffer.allocUnsafe(0),xi=class{constructor(e=0){this.offset=e,this.buffer=tl,this.encoding="utf-8"}setBuffer(e,r){this.offset=e,this.buffer=r}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}string(e){let r=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,r}cstring(){let e=this.offset,r=e;for(;this.buffer[r++]!==0;);return this.offset=r,this.buffer.toString(this.encoding,e,r-1)}bytes(e){let r=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,r}};Je.BufferReader=xi});var Li=h(ae=>{"use strict";var rl=ae&&ae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ae,"__esModule",{value:!0});ae.Parser=void 0;var w=$t(),nl=Oi(),il=rl(require("assert")),zt=1,sl=4,Ii=zt+sl,qi=Buffer.allocUnsafe(0),Di=class{constructor(e){if(this.buffer=qi,this.bufferLength=0,this.bufferOffset=0,this.reader=new nl.BufferReader,(e==null?void 0:e.mode)==="binary")throw new Error("Binary mode not supported yet");this.mode=(e==null?void 0:e.mode)||"text"}parse(e,r){this.mergeBuffer(e);let n=this.bufferOffset+this.bufferLength,i=this.bufferOffset;for(;i+Ii<=n;){let s=this.buffer[i],a=this.buffer.readUInt32BE(i+zt),o=zt+a;if(o+i<=n){let u=this.handlePacket(i+Ii,s,a,this.buffer);r(u),i+=o}else break}i===n?(this.buffer=qi,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=n-i,this.bufferOffset=i)}mergeBuffer(e){if(this.bufferLength>0){let r=this.bufferLength+e.byteLength;if(r+this.bufferOffset>this.buffer.byteLength){let i;if(r<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)i=this.buffer;else{let s=this.buffer.byteLength*2;for(;r>=s;)s*=2;i=Buffer.allocUnsafe(s)}this.buffer.copy(i,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=i,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=r}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,r,n,i){switch(r){case 50:return w.bindComplete;case 49:return w.parseComplete;case 51:return w.closeComplete;case 110:return w.noData;case 115:return w.portalSuspended;case 99:return w.copyDone;case 87:return w.replicationStart;case 73:return w.emptyQuery;case 68:return this.parseDataRowMessage(e,n,i);case 67:return this.parseCommandCompleteMessage(e,n,i);case 90:return this.parseReadyForQueryMessage(e,n,i);case 65:return this.parseNotificationMessage(e,n,i);case 82:return this.parseAuthenticationResponse(e,n,i);case 83:return this.parseParameterStatusMessage(e,n,i);case 75:return this.parseBackendKeyData(e,n,i);case 69:return this.parseErrorMessage(e,n,i,"error");case 78:return this.parseErrorMessage(e,n,i,"notice");case 84:return this.parseRowDescriptionMessage(e,n,i);case 116:return this.parseParameterDescriptionMessage(e,n,i);case 71:return this.parseCopyInMessage(e,n,i);case 72:return this.parseCopyOutMessage(e,n,i);case 100:return this.parseCopyData(e,n,i);default:il.default.fail(`unknown message code: ${r.toString(16)}`)}}parseReadyForQueryMessage(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.string(1);return new w.ReadyForQueryMessage(r,i)}parseCommandCompleteMessage(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.cstring();return new w.CommandCompleteMessage(r,i)}parseCopyData(e,r,n){let i=n.slice(e,e+(r-4));return new w.CopyDataMessage(r,i)}parseCopyInMessage(e,r,n){return this.parseCopyMessage(e,r,n,"copyInResponse")}parseCopyOutMessage(e,r,n){return this.parseCopyMessage(e,r,n,"copyOutResponse")}parseCopyMessage(e,r,n,i){this.reader.setBuffer(e,n);let s=this.reader.byte()!==0,a=this.reader.int16(),o=new w.CopyResponse(r,i,s,a);for(let u=0;u<a;u++)o.columnTypes[u]=this.reader.int16();return o}parseNotificationMessage(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.cstring(),a=this.reader.cstring();return new w.NotificationResponseMessage(r,i,s,a)}parseRowDescriptionMessage(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new w.RowDescriptionMessage(r,i);for(let a=0;a<i;a++)s.fields[a]=this.parseField();return s}parseField(){let e=this.reader.cstring(),r=this.reader.int32(),n=this.reader.int16(),i=this.reader.int32(),s=this.reader.int16(),a=this.reader.int32(),o=this.reader.int16()===0?"text":"binary";return new w.Field(e,r,n,i,s,a,o)}parseParameterDescriptionMessage(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new w.ParameterDescriptionMessage(r,i);for(let a=0;a<i;a++)s.dataTypeIDs[a]=this.reader.int32();return s}parseDataRowMessage(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new Array(i);for(let a=0;a<i;a++){let o=this.reader.int32();s[a]=o===-1?null:this.reader.string(o)}return new w.DataRowMessage(r,s)}parseParameterStatusMessage(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.cstring(),s=this.reader.cstring();return new w.ParameterStatusMessage(r,i,s)}parseBackendKeyData(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.int32();return new w.BackendKeyDataMessage(r,i,s)}parseAuthenticationResponse(e,r,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s={name:"authenticationOk",length:r};switch(i){case 0:break;case 3:s.length===8&&(s.name="authenticationCleartextPassword");break;case 5:if(s.length===12){s.name="authenticationMD5Password";let o=this.reader.bytes(4);return new w.AuthenticationMD5Password(r,o)}break;case 10:s.name="authenticationSASL",s.mechanisms=[];let a;do a=this.reader.cstring(),a&&s.mechanisms.push(a);while(a);break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(r-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(r-8);break;default:throw new Error("Unknown authenticationOk message type "+i)}return s}parseErrorMessage(e,r,n,i){this.reader.setBuffer(e,n);let s={},a=this.reader.string(1);for(;a!=="\0";)s[a]=this.reader.cstring(),a=this.reader.string(1);let o=s.M,u=i==="notice"?new w.NoticeMessage(r,o):new w.DatabaseError(o,r,i);return u.severity=s.S,u.code=s.C,u.detail=s.D,u.hint=s.H,u.position=s.P,u.internalPosition=s.p,u.internalQuery=s.q,u.where=s.W,u.schema=s.s,u.table=s.t,u.column=s.c,u.dataType=s.d,u.constraint=s.n,u.file=s.F,u.line=s.L,u.routine=s.R,u}};ae.Parser=Di});var Zt=h(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.DatabaseError=W.serialize=W.parse=void 0;var al=$t();Object.defineProperty(W,"DatabaseError",{enumerable:!0,get:function(){return al.DatabaseError}});var ol=Ci();Object.defineProperty(W,"serialize",{enumerable:!0,get:function(){return ol.serialize}});var ul=Li();function ll(t,e){let r=new ul.Parser;return t.on("data",n=>r.parse(n,e)),new Promise(n=>t.on("end",()=>n()))}W.parse=ll});var Jt=h((If,Fi)=>{"use strict";var ki=require("net"),fl=require("events").EventEmitter,{parse:hl,serialize:S}=Zt(),Ni=S.flush(),cl=S.sync(),dl=S.end(),Bi=class extends fl{constructor(e){super();e=e||{},this.stream=e.stream||new ki.Socket,this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var r=this;this.on("newListener",function(n){n==="message"&&(r._emitMessage=!0)})}connect(e,r){var n=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,r),this.stream.once("connect",function(){n._keepAlive&&n.stream.setKeepAlive(!0,n._keepAliveInitialDelayMillis),n.emit("connect")});let i=function(s){n._ending&&(s.code==="ECONNRESET"||s.code==="EPIPE")||n.emit("error",s)};if(this.stream.on("error",i),this.stream.on("close",function(){n.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(s){var a=s.toString("utf8");switch(a){case"S":break;case"N":return n.stream.end(),n.emit("error",new Error("The server does not support SSL connections"));default:return n.stream.end(),n.emit("error",new Error("There was an error establishing an SSL connection"))}var o=require("tls");let u={socket:n.stream};n.ssl!==!0&&(Object.assign(u,n.ssl),"key"in n.ssl&&(u.key=n.ssl.key)),ki.isIP(r)===0&&(u.servername=r);try{n.stream=o.connect(u)}catch(l){return n.emit("error",l)}n.attachListeners(n.stream),n.stream.on("error",i),n.emit("sslconnect")})}attachListeners(e){e.on("end",()=>{this.emit("end")}),hl(e,r=>{var n=r.name==="error"?"errorMessage":r.name;this._emitMessage&&this.emit("message",r),this.emit(n,r)})}requestSsl(){this.stream.write(S.requestSsl())}startup(e){this.stream.write(S.startup(e))}cancel(e,r){this._send(S.cancel(e,r))}password(e){this._send(S.password(e))}sendSASLInitialResponseMessage(e,r){this._send(S.sendSASLInitialResponseMessage(e,r))}sendSCRAMClientFinalMessage(e){this._send(S.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(S.query(e))}parse(e){this._send(S.parse(e))}bind(e){this._send(S.bind(e))}execute(e){this._send(S.execute(e))}flush(){this.stream.writable&&this.stream.write(Ni)}sync(){this._ending=!0,this._send(Ni),this._send(cl)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(dl,()=>{this.stream.end()})}close(e){this._send(S.close(e))}describe(e){this._send(S.describe(e))}sendCopyFromChunk(e){this._send(S.copyData(e))}endCopyFrom(){this._send(S.copyDone())}sendCopyFail(e){this._send(S.copyFail(e))}};Fi.exports=Bi});var Ui=h((Df,ji)=>{"use strict";var pl=require("events").EventEmitter,qf=require("util"),yl=xe(),Xt=jr(),_l=Kn(),ml=Wt(),gl=Vt(),Qi=hi(),vl=pe(),bl=Jt(),er=class extends pl{constructor(e){super();this.connectionParameters=new gl(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var r=e||{};this._Promise=r.Promise||global.Promise,this._types=new ml(r.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=r.connection||new bl({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||vl.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){var r=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(i)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){r.ssl?n.requestSsl():n.startup(r.getStartupConf())}),n.on("sslconnect",function(){n.startup(r.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,n)=>{this._connect(i=>{i?n(i):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{r.emit("error",n)}):this.password!==null?e():_l(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(()=>{let r=yl.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)})}_handleAuthSASL(e){this._checkPgPass(()=>{this.saslSession=Xt.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(e){Xt.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(e){Xt.finalizeSession(this.saslSession,e.data),this.saslSession=null}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,r={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(r.application_name=n),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){var n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,n){return this._types.setTypeParser(e,r,n)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return'"'+e.replace(/"/g,'""')+'"'}escapeLiteral(e){for(var r=!1,n="'",i=0;i<e.length;i++){var s=e[i];s==="'"?n+=s+s:s==="\\"?(n+=s+s,r=!0):n+=s}return n+="'",r===!0&&(n=" E"+n),n}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,n){var i,s,a,o,u;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,s=i=e,typeof r=="function"&&(i.callback=i.callback||r)):(a=this.connectionParameters.query_timeout,i=new Qi(e,r,n),i.callback||(s=new this._Promise((l,f)=>{i.callback=(c,y)=>c?f(c):l(y)}))),a&&(u=i.callback,o=setTimeout(()=>{var l=new Error("Query read timeout");process.nextTick(()=>{i.handleError(l,this.connection)}),u(l),i.callback=()=>{};var f=this.queryQueue.indexOf(i);f>-1&&this.queryQueue.splice(f,1),this._pulseQueryQueue()},a),i.callback=(l,f)=>{clearTimeout(o),u(l,f)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),s):(this.queryQueue.push(i),this._pulseQueryQueue(),s):(process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),s)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};er.Query=Qi;ji.exports=er});var Yi=h((Lf,$i)=>{"use strict";var wl=require("events").EventEmitter,Wi=function(){},Gi=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},Hi=class{constructor(e,r,n){this.client=e,this.idleListener=r,this.timeoutId=n}},Xe=class{constructor(e){this.callback=e}};function Sl(){throw new Error("Release called on client which has already been released to the pool.")}function et(t,e){if(e)return{callback:e,result:void 0};let r,n,i=function(a,o){a?r(a):n(o)},s=new t(function(a,o){n=a,r=o});return{callback:i,result:s}}function El(t,e){return function r(n){n.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var Vi=class extends wl{constructor(e,r){super();this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.log=this.options.log||function(){},this.Client=this.options.Client||r||tr().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis=="undefined"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let n=r.client;n.ref&&n.ref();let i=r.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e){let r=Gi(this._idle,n=>n.client===e);r!==void 0&&clearTimeout(r.timeoutId),this._clients=this._clients.filter(n=>n!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let r=et(this.Promise,e),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new Xe(r.callback)),n;let i=(o,u,l)=>{clearTimeout(a),r.callback(o,u,l)},s=new Xe(i),a=setTimeout(()=>{Gi(this._pendingQueue,o=>o.callback===i),s.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(s),n}return this.newClient(new Xe(r.callback)),n}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let n=El(this,r);this.log("checking client timeout");let i,s=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),s=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(a=>{if(i&&clearTimeout(i),r.on("error",n),a)this.log("client failed to connect",a),this._clients=this._clients.filter(o=>o!==r),s&&(a.message="Connection terminated due to connection timeout"),this._pulseQueue(),e.timedOut||e.callback(a,void 0,Wi);else return this.log("new client connected"),this._acquireClient(r,e,n,!0)})}_acquireClient(e,r,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),r.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,s=>{if(s)return e.release(s),r.callback(s,void 0,Wi);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let n=!1;return i=>{n&&Sl(),n=!0,this._release(e,r,i)}}_release(e,r,n){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}let i;this.options.idleTimeoutMillis&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new Hi(e,r,i)),this._pulseQueue()}query(e,r,n){if(typeof e=="function"){let s=et(this.Promise,e);return setImmediate(function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),s.result}typeof r=="function"&&(n=r,r=void 0);let i=et(this.Promise,n);return n=i.callback,this.connect((s,a)=>{if(s)return n(s);let o=!1,u=l=>{o||(o=!0,a.release(l),n(l))};a.once("error",u),this.log("dispatching query"),a.query(e,r,(l,f)=>{if(this.log("query dispatched"),a.removeListener("error",u),!o)return o=!0,a.release(l),l?n(l):n(void 0,f)})}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let r=et(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get totalCount(){return this._clients.length}};$i.exports=Vi});var Ki=h((kf,Rl)=>{Rl.exports={name:"pg",version:"8.7.1",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.4.1","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"0.9.0",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=2.0.0"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"92b4d37926c276d343bfe56447ff6f526af757cf"}});var Ji=h((Nf,Zi)=>{"use strict";var zi=require("events").EventEmitter,Tl=require("util"),rr=xe(),oe=Zi.exports=function(t,e,r){zi.call(this),t=rr.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};Tl.inherits(oe,zi);var Ml={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};oe.prototype.handleError=function(t){var e=this.native.pq.resultErrorFields();if(e)for(var r in e){var n=Ml[r]||r;t[n]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};oe.prototype.then=function(t,e){return this._getPromise().then(t,e)};oe.prototype.catch=function(t){return this._getPromise().catch(t)};oe.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};oe.prototype.submit=function(t){this.state="running";var e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;var r=function(s,a,o){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),s)return e.handleError(s);e._emitRowEvents&&(o.length>1?a.forEach((u,l)=>{u.forEach(f=>{e.emit("row",f,o[l])})}):a.forEach(function(u){e.emit("row",u,o)})),e.state="end",e.emit("end",o),e.callback&&e.callback(null,o)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var n=(this.values||[]).map(rr.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let s=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(s)}return t.native.execute(this.name,n,r)}return t.native.prepare(this.name,this.text,n.length,function(s){return s?r(s):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,r))})}else if(this.values){if(!Array.isArray(this.values)){let s=new Error("Query values must be an array");return r(s)}var i=this.values.map(rr.prepareValue);t.native.query(this.text,i,r)}else t.native.query(this.text,r)}});var rs=h((Ff,ts)=>{"use strict";var Pl=require("pg-native"),Al=Wt(),Bf=Ki(),Xi=require("events").EventEmitter,Cl=require("util"),xl=Vt(),es=Ji(),P=ts.exports=function(t){Xi.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new Al(t.types),this.native=new Pl({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var e=this.connectionParameters=new xl(t);this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};P.Query=es;Cl.inherits(P,Xi);P.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};P.prototype._connect=function(t){var e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,n){if(r)return t(r);e.native.connect(n,function(i){if(i)return e.native.end(),t(i);e._connected=!0,e.native.on("error",function(s){e._queryable=!1,e._errorAllQueries(s),e.emit("error",s)}),e.native.on("notification",function(s){e.emit("notification",{channel:s.relname,payload:s.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};P.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(n=>{n?r(n):e()})})};P.prototype.query=function(t,e,r){var n,i,s,a,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")s=t.query_timeout||this.connectionParameters.query_timeout,i=n=t,typeof e=="function"&&(t.callback=e);else if(s=this.connectionParameters.query_timeout,n=new es(t,e,r),!n.callback){let u,l;i=new this._Promise((f,c)=>{u=f,l=c}),n.callback=(f,c)=>f?l(f):u(c)}return s&&(o=n.callback,a=setTimeout(()=>{var u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),o(u),n.callback=()=>{};var l=this._queryQueue.indexOf(n);l>-1&&this._queryQueue.splice(l,1),this._pulseQueryQueue()},s),n.callback=(u,l)=>{clearTimeout(a),o(u,l)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};P.prototype.end=function(t){var e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));var r;return t||(r=new this._Promise(function(n,i){t=s=>s?i(s):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};P.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};P.prototype._pulseQueryQueue=function(t){if(!!this._connected&&!this._hasActiveQuery()){var e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);var r=this;e.once("_done",function(){r._pulseQueryQueue()})}};P.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};P.prototype.ref=function(){};P.prototype.unref=function(){};P.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};P.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var nr=h((Qf,ns)=>{"use strict";ns.exports=rs()});var tr=h((Uf,Re)=>{"use strict";var Ol=Ui(),Il=pe(),ql=Jt(),Dl=Yi(),{DatabaseError:Ll}=Zt(),kl=t=>class extends Dl{constructor(r){super(r,t)}},ir=function(t){this.defaults=Il,this.Client=t,this.Query=this.Client.Query,this.Pool=kl(this.Client),this._pools=[],this.Connection=ql,this.types=de(),this.DatabaseError=Ll};typeof process.env.NODE_PG_FORCE_NATIVE!="undefined"?Re.exports=new ir(nr()):(Re.exports=new ir(Ol),Object.defineProperty(Re.exports,"native",{configurable:!0,enumerable:!1,get(){var t=null;try{t=new ir(nr())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Re.exports,"native",{value:t}),t}}))});sr(exports);Te(exports,ls(tr()));
